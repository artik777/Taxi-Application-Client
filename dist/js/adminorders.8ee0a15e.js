(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["adminorders"],{"0bef":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.comments,"hide-default-footer":""},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"orange accent-2 black--text"}},[a("v-toolbar-title",[t._v("All comments")])],1)]},proxy:!0}])}),a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12",lg:"4",sm:"8",md:"5"}},[t.loggedIn?a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{color:"orange accent-2 black--text",flat:""}},[a("v-toolbar-title",[t._v("Write a comment")]),a("v-spacer")],1),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{filled:"",label:"Your name",rules:[function(t){return t&&t.length>=2&&t.length<=20||"Name must have 2 and more characters, but less than 20 characters"}]},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),a("v-textarea",{attrs:{filled:"",counter:500,label:"Your comment",rules:[function(t){return t&&t.length>=5&&t.length<=500||"Comment must have 5 and more characters, but less than 500 characters"}]},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{disabled:!t.valid,color:"orange accent-2 black--text"},on:{click:t.send}},[t._v("Send")])],1)],1)],1)],1):a("p",[t._v("If you want to add a comment, please login")])],1)],1)],1)},i=[],n=(a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),s=a("5530"),o=a("2f62"),l={data:function(){return{name:"",comment:"",timestamp:new Date,options:{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},items:[],loading:!0,valid:!0,headers:[{text:"Name",sortable:!1,value:"name"},{text:"Comment",sortable:!1,value:"comment"},{text:"Datetime",sortable:!1,value:"timestamp"},{text:"Ip ",sortable:!1,value:"ip"}],ip:""}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(o["b"])({token:"getToken"})),Object(o["b"])({comments:"getComments"})),{},{error:function(){return this.$store.getters.error}}),beforeMount:function(){""!=this.token&&(this.loggedIn=!0)},mounted:function(){var t=this;fetch("https://api.ipify.org?format=json").then((function(t){return t.json()})).then((function(e){var a=e.ip;t.ip=a}))},methods:{send:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a={name:t.name,comment:t.comment,timestamp:new Intl.DateTimeFormat("lt",t.options).format(t.timestamp),ip:t.ip};try{t.$store.dispatch("createComment",a),t.name="",t.comment="",t.close()}catch(r){t.$store.dispatch("setError",r.response.data),t.close()}case 2:case"end":return e.stop()}}),e)})))()}}},c=l,u=a("2877"),d=a("6544"),m=a.n(d),v=a("8336"),p=a("b0af"),h=a("99d9"),f=a("62ad"),b=a("a523"),x=a("8fea"),g=a("4bd4"),k=a("0fd9"),y=a("2fa4"),I=a("8654"),C=(a("a9e3"),a("1681"),a("58df")),w=Object(C["a"])(I["a"]),_=w.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return Object(s["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},I["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var t=this.$refs.input;if(t){t.style.height="0";var e=t.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(a,e)+"px"}},genInput:function(){var t=I["a"].options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput:function(t){I["a"].options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}}),V=a("71d9"),T=a("2a7f"),O=Object(u["a"])(c,r,i,!1,null,null,null);e["default"]=O.exports;m()(O,{VBtn:v["a"],VCard:p["a"],VCardActions:h["a"],VCardText:h["c"],VCol:f["a"],VContainer:b["a"],VDataTable:x["a"],VForm:g["a"],VRow:k["a"],VSpacer:y["a"],VTextField:I["a"],VTextarea:_,VToolbar:V["a"],VToolbarTitle:T["a"]})},1681:function(t,e,a){},ec5c:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("OrdersTable",{attrs:{items:t.items}}),a("ProfitTable",{attrs:{items:t.items}})],1)},i=[],n=a("5530"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.items,loading:t.loading,"sort-by":"priceSell",search:t.search},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("My Orders")]),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),a("v-spacer"),a("v-btn",{on:{click:t.onRefresh}},[t._v("refresh")]),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",{scopedSlots:t._u([{key:"item.actions",fn:function(e){var r=e.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editItem(r,r._id)}}},[t._v("mdi-pencil")]),a("v-icon",{attrs:{small:""},on:{click:function(e){return t.deleteItem(r,r._id)}}},[t._v("mdi-delete")])]}}],null,!0)},[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Edit order")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-select",{attrs:{items:t.options,label:"Change status"},model:{value:t.editedItem.status,callback:function(e){t.$set(t.editedItem,"status",e)},expression:"editedItem.status"}})],1),a("v-col",[a("v-time-picker",{attrs:{format:"24hr",color:"orange"},model:{value:t.editedItem.timearrived,callback:function(e){t.$set(t.editedItem,"timearrived",e)},expression:"editedItem.timearrived"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.close}},[t._v("Cancel")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){return t.save()}}},[t._v("Save")])],1)],1)],1)],1)]},proxy:!0},{key:"item.price",fn:function(e){var r=e.item;return[a("v-chip",{attrs:{color:t.priceColor(r.price),dark:""}},[t._v(" "+t._s(new Intl.NumberFormat("lt",{style:"currency",currency:"EUR",maximumDecimalPlaces:0}).format(r.price))+" ")])]}},{key:"item.status",fn:function(e){var r=e.item;return[a("v-chip",{attrs:{color:t.statusColor(r.status),dark:""}},[t._v(t._s(r.status))])]}},{key:"item.actions",fn:function(e){var r=e.item;return[(t.legalStatus=t.statusOrder(r.status))?a("v-icon",{attrs:{small:""},on:{click:function(e){return t.editItem(r)}}},[t._v("mdi-pencil")]):t._e()]}}],null,!0)})],1)},o=[],l=(a("c740"),a("c975"),a("a9e3"),a("d3b7"),a("59ca")),c=a.n(l),u=(a("66ce"),a("2f62")),d={name:"Orders",props:["items","loading"],data:function(){return{options:["Completed","Canceled"],dialog:!1,search:"",headers:[{text:"Name",sortable:!1,value:"name"},{text:"Surname",sortable:!1,value:"surname"},{text:"Phone nr",sortable:!1,value:"phone"},{text:"Category",sortable:!1,value:"category"},{text:"Quantity",sortable:!1,value:"orderQuantity"},{text:"Price per hour",sortable:!1,value:"price"},{text:"Pickup Address",sortable:!1,value:"pickupAddress"},{text:"Destination Address",sortable:!1,value:"destinationAddress"},{text:"Email",sortable:!1,value:"email"},{text:"Pickup time",sortable:!1,value:"time"},{text:"Pickup date",sortable:!1,value:"date"},{text:"Time ordered",sortable:!1,value:"timestamp"},{text:"Status",sortable:!1,value:"status"},{text:"Actions",value:"actions",sortable:!1}],selected:[],editedIndex:-1,editedItem:{status:"",timearrived:""},numberRules:[function(t){return!!t||"Field is required"},function(t){return/^\d+$/.test(t)||"Must be a number"}],legalStatus:!1}},computed:Object(n["a"])({},Object(u["b"])({ads:"ads"})),methods:{editItem:function(t){this.editedIndex=this.items.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},onRefresh:function(){this.$store.dispatch("fetchOrders")},priceColor:function(t){return t>=30?"red":t>=20?"orange":"green"},statusColor:function(t){return"Completed"===t?"green":"Canceled"===t?"red":"orange"},statusOrder:function(t){return this.legalStatus="Completed"!==t&&"Canceled"!==t},close:function(){var t=this;this.dialog=!1,this.$nextTick((function(){t.editedItem=Object.assign({})}))},save:function(){if(this.editedIndex>-1){var t=this.items[this.editedIndex]._id,e=this.items[this.editedIndex].ordernr,a=this.items[this.editedIndex].orderQuantity,r=this.ads.findIndex((function(t){return t.id==e})),i=Number(this.ads[r].quantity)+Number(a);Object.assign(this.items[this.editedIndex],this.editedItem),fetch("https://taxicodeacademy.herokuapp.com/api/orders/"+t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:this.editedItem.status,timearrived:this.editedItem.timearrived})}).then((function(t){return t.json()})),"Completed"!==this.editedItem.status&&"Canceled"!==this.editedItem.status||c.a.database().ref("cars").child(e).update({quantity:i})}else this.items.push(this.editedItem);this.close()}},watch:{dialog:function(t){t||this.close()}}},m=d,v=a("2877"),p=a("6544"),h=a.n(p),f=a("8336"),b=a("b0af"),x=a("99d9"),g=a("cc20"),k=a("62ad"),y=a("a523"),I=a("8fea"),C=a("169a"),w=a("132d"),_=a("0fd9"),V=a("b974"),T=a("2fa4"),O=a("8654"),N=a("c964"),j=a("71d9"),P=a("2a7f"),S=Object(v["a"])(m,s,o,!1,null,null,null),$=S.exports;h()(S,{VBtn:f["a"],VCard:b["a"],VCardActions:x["a"],VCardText:x["c"],VCardTitle:x["d"],VChip:g["a"],VCol:k["a"],VContainer:y["a"],VDataTable:I["a"],VDialog:C["a"],VIcon:w["a"],VRow:_["a"],VSelect:V["a"],VSpacer:T["a"],VTextField:O["a"],VTimePicker:N["a"],VToolbar:j["a"],VToolbarTitle:P["a"]});var A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.filteredItems},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("My Profit")])],1)]},proxy:!0},{key:"item.profit",fn:function(e){var r=e.item;return[a("v-chip",{attrs:{dark:""}},[t._v(" "+t._s((r.price*r.orderQuantity*Math.abs(60*Number(r.time.split(":")[0])+Number(r.time.slice(3))-(60*Number(r.timearrived.split(":")[0])+Number(r.timearrived.slice(3))))/60).toFixed(2)+" €")+" ")])]}},{key:"item.timespent",fn:function(e){var r=e.item;return[a("v-chip",{attrs:{dark:""}},[t._v(" "+t._s(Math.abs(60*Number(r.time.split(":")[0])+Number(r.time.slice(3))-(60*Number(r.timearrived.split(":")[0])+Number(r.timearrived.slice(3)))))+" ")])]}}],null,!0)}),a("v-chip",{attrs:{dark:""}},[t._v(" "+t._s("TOTAL PROFIT: "+Number(t.totalProfit).toFixed(2)+" €")+" ")])],1)},R=[],F=(a("4de4"),a("d81d"),a("13d5"),a("fb6a"),a("ac1f"),a("1276"),{name:"Orders",props:["items"],data:function(){return{headers:[{text:"Car model",sortable:!1,value:"carModel"},{text:"Category",sortable:!1,value:"category"},{text:"Quantity",sortable:!1,value:"orderQuantity"},{text:"Price per hour in €",sortable:!1,value:"price"},{text:"Time spent in min",sortable:!1,value:"timespent"},{text:"Pickup Address",sortable:!1,value:"pickupAddress"},{text:"Destination Address",sortable:!1,value:"destinationAddress"},{text:"Pickup date",sortable:!1,value:"date"},{text:"Pickup time",sortable:!1,value:"time"},{text:"Arrived time",sortable:!1,value:"timearrived"},{text:"Time ordered",sortable:!1,value:"timestamp"},{text:"Status",sortable:!1,value:"status"},{text:"Profit",sortable:!1,value:"profit"}]}},computed:{filteredItems:function(){return this.items.map((function(t){return t})).filter((function(t){return"Completed"===t.status}))},totalProfit:function(){return this.filteredItems.map((function(t){var e=Math.abs(60*Number(t.time.split(":")[0])+Number(t.time.slice(3))-(60*Number(t.timearrived.split(":")[0])+Number(t.timearrived.slice(3))));return t.price*t.orderQuantity*e/60})).reduce((function(t,e){return[+t+ +e]}),0)}}}),H=F,D=Object(v["a"])(H,A,R,!1,null,null,null),M=D.exports;h()(D,{VChip:g["a"],VContainer:y["a"],VDataTable:I["a"],VToolbar:j["a"],VToolbarTitle:P["a"]});var E={data:function(){return{}},computed:Object(n["a"])({},Object(u["b"])({items:"getOrders"})),components:{OrdersTable:$,ProfitTable:M}},z=E,G=Object(v["a"])(z,r,i,!1,null,null,null);e["default"]=G.exports}}]);
//# sourceMappingURL=adminorders.8ee0a15e.js.map