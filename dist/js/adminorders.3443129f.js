(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["adminorders"],{"0bef":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.comments,"hide-default-footer":""},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"orange accent-2 black--text"}},[a("v-toolbar-title",[e._v("All comments")]),a("v-spacer"),a("v-btn",{on:{click:e.onRefresh}},[e._v("refresh")])],1)]},proxy:!0}])}),a("v-expansion-panels",[a("v-expansion-panel",[a("v-expansion-panel-header",[e._v("Write your comment")]),a("v-expansion-panel-content",[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12",lg:"4",sm:"8",md:"5"}},[e.loggedIn?a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",{attrs:{color:"orange accent-2 black--text",flat:""}},[a("v-toolbar-title",[e._v("Write a comment")]),a("v-spacer")],1),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-text-field",{attrs:{filled:"",label:"Your name",rules:[function(e){return e&&e.length>=2&&e.length<=20||"Name must have 2 and more characters, but less than 20 characters"}]},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("v-textarea",{attrs:{filled:"",counter:500,label:"Your comment",rules:[function(e){return e&&e.length>=5&&e.length<=500||"Comment must have 5 and more characters, but less than 500 characters"}]},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{disabled:!e.valid,color:"orange accent-2 black--text"},on:{click:e.send}},[e._v("Send")])],1)],1)],1)],1):a("p",[e._v(" If you want to add a comment, please "),a("router-link",{attrs:{to:"/register"}},[e._v("register and login")])],1)],1)],1)],1)],1)],1)],1)},i=[],s=(a("b0c0"),a("96cf"),a("1da1")),r=a("5530"),o=a("2f62"),l={data:function(){return{name:"",comment:"",timestamp:new Date,options:{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},items:[],loading:!0,valid:!0,headers:[{text:"Name",sortable:!1,value:"name"},{text:"Comment",sortable:!1,value:"comment"},{text:"Datetime",sortable:!1,value:"timestamp"}],ip:""}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(o["b"])({token:"getToken"})),Object(o["b"])({comments:"getComments"})),{},{error:function(){return this.$store.getters.error}}),beforeMount:function(){""!=this.token&&(this.loggedIn=!0)},methods:{onRefresh:function(){this.$store.dispatch("fetchComments")},send:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a={name:e.name,comment:e.comment,timestamp:new Intl.DateTimeFormat("lt",e.options).format(e.timestamp)};try{e.$store.dispatch("createComment",a),e.close()}catch(n){e.$store.dispatch("setError",n.response.data),e.close()}case 2:case"end":return t.stop()}}),t)})))()}}},c=l,d=a("2877"),u=a("6544"),p=a.n(u),m=a("8336"),h=a("b0af"),v=a("99d9"),f=a("62ad"),b=a("a523"),x=a("8fea"),g=a("4e82"),y=a("3206"),k=a("80d2"),C=a("58df"),I=Object(C["a"])(Object(g["a"])("expansionPanels","v-expansion-panel","v-expansion-panels"),Object(y["b"])("expansionPanel",!0)).extend({name:"v-expansion-panel",props:{disabled:Boolean,readonly:Boolean},data:function(){return{content:null,header:null,nextIsActive:!1}},computed:{classes:function(){return Object(r["a"])({"v-expansion-panel--active":this.isActive,"v-expansion-panel--next-active":this.nextIsActive,"v-expansion-panel--disabled":this.isDisabled},this.groupClasses)},isDisabled:function(){return this.expansionPanels.disabled||this.disabled},isReadonly:function(){return this.expansionPanels.readonly||this.readonly}},methods:{registerContent:function(e){this.content=e},unregisterContent:function(){this.content=null},registerHeader:function(e){this.header=e,e.$on("click",this.onClick)},unregisterHeader:function(){this.header=null},onClick:function(e){e.detail&&this.header.$el.blur(),this.$emit("click",e),this.isReadonly||this.isDisabled||this.toggle()},toggle:function(){var e=this;this.content&&(this.content.isBooted=!0),this.$nextTick((function(){return e.$emit("change")}))}},render:function(e){return e("div",{staticClass:"v-expansion-panel",class:this.classes,attrs:{"aria-expanded":String(this.isActive)}},Object(k["s"])(this))}}),O=a("0789"),w=a("9d65"),_=a("a9ad"),V=Object(C["a"])(w["a"],_["a"],Object(y["a"])("expansionPanel","v-expansion-panel-content","v-expansion-panel")),j=V.extend().extend({name:"v-expansion-panel-content",computed:{isActive:function(){return this.expansionPanel.isActive}},created:function(){this.expansionPanel.registerContent(this)},beforeDestroy:function(){this.expansionPanel.unregisterContent()},render:function(e){var t=this;return e(O["a"],this.showLazyContent((function(){return[e("div",t.setBackgroundColor(t.color,{staticClass:"v-expansion-panel-content",directives:[{name:"show",value:t.isActive}]}),[e("div",{class:"v-expansion-panel-content__wrap"},Object(k["s"])(t))])]})))}}),P=a("9d26"),T=a("5607"),A=Object(C["a"])(_["a"],Object(y["a"])("expansionPanel","v-expansion-panel-header","v-expansion-panel")),$=A.extend().extend({name:"v-expansion-panel-header",directives:{ripple:T["a"]},props:{disableIconRotate:Boolean,expandIcon:{type:String,default:"$expand"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1}},data:function(){return{hasMousedown:!1}},computed:{classes:function(){return{"v-expansion-panel-header--active":this.isActive,"v-expansion-panel-header--mousedown":this.hasMousedown}},isActive:function(){return this.expansionPanel.isActive},isDisabled:function(){return this.expansionPanel.isDisabled},isReadonly:function(){return this.expansionPanel.isReadonly}},created:function(){this.expansionPanel.registerHeader(this)},beforeDestroy:function(){this.expansionPanel.unregisterHeader()},methods:{onClick:function(e){this.$emit("click",e)},genIcon:function(){var e=Object(k["s"])(this,"actions")||[this.$createElement(P["a"],this.expandIcon)];return this.$createElement(O["c"],[this.$createElement("div",{staticClass:"v-expansion-panel-header__icon",class:{"v-expansion-panel-header__icon--disable-rotate":this.disableIconRotate},directives:[{name:"show",value:!this.isDisabled}]},e)])}},render:function(e){var t=this;return e("button",this.setBackgroundColor(this.color,{staticClass:"v-expansion-panel-header",class:this.classes,attrs:{tabindex:this.isDisabled?-1:null,type:"button"},directives:[{name:"ripple",value:this.ripple}],on:Object(r["a"])(Object(r["a"])({},this.$listeners),{},{click:this.onClick,mousedown:function(){return t.hasMousedown=!0},mouseup:function(){return t.hasMousedown=!1}})}),[Object(k["s"])(this,"default",{open:this.isActive},!0),this.hideActions||this.genIcon()])}}),N=(a("0481"),a("4069"),a("210b"),a("604c")),B=a("d9bd"),R=N["a"].extend({name:"v-expansion-panels",provide:function(){return{expansionPanels:this}},props:{accordion:Boolean,disabled:Boolean,flat:Boolean,hover:Boolean,focusable:Boolean,inset:Boolean,popout:Boolean,readonly:Boolean,tile:Boolean},computed:{classes:function(){return Object(r["a"])(Object(r["a"])({},N["a"].options.computed.classes.call(this)),{},{"v-expansion-panels":!0,"v-expansion-panels--accordion":this.accordion,"v-expansion-panels--flat":this.flat,"v-expansion-panels--hover":this.hover,"v-expansion-panels--focusable":this.focusable,"v-expansion-panels--inset":this.inset,"v-expansion-panels--popout":this.popout,"v-expansion-panels--tile":this.tile})}},created:function(){this.$attrs.hasOwnProperty("expand")&&Object(B["a"])("expand","multiple",this),Array.isArray(this.value)&&this.value.length>0&&"boolean"===typeof this.value[0]&&Object(B["a"])(':value="[true, false, true]"',':value="[0, 2]"',this)},methods:{updateItem:function(e,t){var a=this.getValue(e,t),n=this.getValue(e,t+1);e.isActive=this.toggleMethod(a),e.nextIsActive=this.toggleMethod(n)}}}),S=a("4bd4"),D=a("0fd9"),H=a("2fa4"),E=a("8654"),M=(a("a9e3"),a("1681"),Object(C["a"])(E["a"])),F=M.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(e){return!isNaN(parseFloat(e))}},rows:{type:[Number,String],default:5,validator:function(e){return!isNaN(parseInt(e,10))}}},computed:{classes:function(){return Object(r["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},E["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var e=this;setTimeout((function(){e.autoGrow&&e.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var e=this.$refs.input;if(e){e.style.height="0";var t=e.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);e.style.height=Math.max(a,t)+"px"}},genInput:function(){var e=E["a"].options.methods.genInput.call(this);return e.tag="textarea",delete e.data.attrs.type,e.data.attrs.rows=this.rows,e},onInput:function(e){E["a"].options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}}),z=a("71d9"),G=a("2a7f"),Q=Object(d["a"])(c,n,i,!1,null,null,null);t["default"]=Q.exports;p()(Q,{VBtn:m["a"],VCard:h["a"],VCardActions:v["a"],VCardText:v["c"],VCol:f["a"],VContainer:b["a"],VDataTable:x["a"],VExpansionPanel:I,VExpansionPanelContent:j,VExpansionPanelHeader:$,VExpansionPanels:R,VForm:S["a"],VRow:D["a"],VSpacer:H["a"],VTextField:E["a"],VTextarea:F,VToolbar:z["a"],VToolbarTitle:G["a"]})},1681:function(e,t,a){},"210b":function(e,t,a){},ec5c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("OrdersTable",{attrs:{items:e.items}}),a("ProfitTable",{attrs:{items:e.items}})],1)},i=[],s=a("5530"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,loading:e.loading,"sort-by":"price",search:e.search},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[e._v("My Orders")]),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("v-spacer"),a("v-btn",{on:{click:e.onRefresh}},[e._v("refresh")]),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",{scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(n,n._id)}}},[e._v("mdi-pencil")]),a("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(n,n._id)}}},[e._v("mdi-delete")])]}}],null,!0)},[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Edit order")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-select",{attrs:{items:e.options,label:"Change status"},model:{value:e.editedItem.status,callback:function(t){e.$set(e.editedItem,"status",t)},expression:"editedItem.status"}})],1),a("v-col",[a("v-time-picker",{attrs:{format:"24hr",color:"orange"},model:{value:e.editedItem.timearrived,callback:function(t){e.$set(e.editedItem,"timearrived",t)},expression:"editedItem.timearrived"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v("Cancel")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.save()}}},[e._v("Save")])],1)],1)],1)],1)]},proxy:!0},{key:"item.price",fn:function(t){var n=t.item;return[a("v-chip",{attrs:{color:e.priceColor(n.price),dark:""}},[e._v(" "+e._s(new Intl.NumberFormat("lt",{style:"currency",currency:"EUR",maximumDecimalPlaces:0}).format(n.price))+" ")])]}},{key:"item.status",fn:function(t){var n=t.item;return[a("v-chip",{attrs:{color:e.statusColor(n.status),dark:""}},[e._v(e._s(n.status))])]}},{key:"item.actions",fn:function(t){var n=t.item;return[(e.legalStatus=e.statusOrder(n.status))?a("v-icon",{attrs:{small:""},on:{click:function(t){return e.editItem(n)}}},[e._v("mdi-pencil")]):e._e()]}}],null,!0)})],1)},o=[],l=(a("c740"),a("c975"),a("a9e3"),a("d3b7"),a("59ca")),c=a.n(l),d=(a("66ce"),a("2f62")),u={name:"Orders",props:["items","loading"],data:function(){return{options:["Completed","Canceled"],dialog:!1,search:"",headers:[{text:"Name",sortable:!1,value:"name"},{text:"Surname",sortable:!1,value:"surname"},{text:"Phone nr",sortable:!1,value:"phone"},{text:"Category",sortable:!1,value:"category"},{text:"Quantity",sortable:!1,value:"orderQuantity"},{text:"Price per hour",sortable:!1,value:"price"},{text:"Pickup Address",sortable:!1,value:"pickupAddress"},{text:"Destination Address",sortable:!1,value:"destinationAddress"},{text:"Email",sortable:!1,value:"email"},{text:"Pickup time",sortable:!1,value:"time"},{text:"Pickup date",sortable:!1,value:"date"},{text:"Time ordered",sortable:!1,value:"timestamp"},{text:"Status",sortable:!1,value:"status"},{text:"Actions",value:"actions",sortable:!1}],selected:[],editedIndex:-1,editedItem:{status:"",timearrived:""},numberRules:[function(e){return!!e||"Field is required"},function(e){return/^\d+$/.test(e)||"Must be a number"}],legalStatus:!1}},computed:Object(s["a"])({},Object(d["b"])({ads:"ads"})),methods:{editItem:function(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},onRefresh:function(){this.$store.dispatch("fetchOrders")},priceColor:function(e){return e>=30?"red":e>=20?"orange":"green"},statusColor:function(e){return"Completed"===e?"green":"Canceled"===e?"red":"orange"},statusOrder:function(e){return this.legalStatus="Completed"!==e&&"Canceled"!==e},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({})}))},save:function(){if(this.editedIndex>-1){var e=this.items[this.editedIndex]._id,t=this.items[this.editedIndex].ordernr,a=this.items[this.editedIndex].orderQuantity,n=this.ads.findIndex((function(e){return e.id==t})),i=Number(this.ads[n].quantity)+Number(a);Object.assign(this.items[this.editedIndex],this.editedItem),fetch("https://taxicodeacademy.herokuapp.com/api/orders/"+e,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:this.editedItem.status,timearrived:this.editedItem.timearrived})}).then((function(e){return e.json()})),"Completed"!==this.editedItem.status&&"Canceled"!==this.editedItem.status||c.a.database().ref("cars").child(t).update({quantity:i})}else this.items.push(this.editedItem);this.close()}},watch:{dialog:function(e){e||this.close()}}},p=u,m=a("2877"),h=a("6544"),v=a.n(h),f=a("8336"),b=a("b0af"),x=a("99d9"),g=a("cc20"),y=a("62ad"),k=a("a523"),C=a("8fea"),I=a("169a"),O=a("132d"),w=a("0fd9"),_=a("b974"),V=a("2fa4"),j=a("8654"),P=a("c964"),T=a("71d9"),A=a("2a7f"),$=Object(m["a"])(p,r,o,!1,null,null,null),N=$.exports;v()($,{VBtn:f["a"],VCard:b["a"],VCardActions:x["a"],VCardText:x["c"],VCardTitle:x["d"],VChip:g["a"],VCol:y["a"],VContainer:k["a"],VDataTable:C["a"],VDialog:I["a"],VIcon:O["a"],VRow:w["a"],VSelect:_["a"],VSpacer:V["a"],VTextField:j["a"],VTimePicker:P["a"],VToolbar:T["a"],VToolbarTitle:A["a"]});var B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.filteredItems},scopedSlots:e._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[e._v("My Profit")])],1)]},proxy:!0},{key:"item.profit",fn:function(t){var n=t.item;return[a("v-chip",{attrs:{dark:""}},[e._v(" "+e._s((n.price*n.orderQuantity*Math.abs(60*Number(n.time.split(":")[0])+Number(n.time.slice(3))-(60*Number(n.timearrived.split(":")[0])+Number(n.timearrived.slice(3))))/60).toFixed(2)+" €")+" ")])]}},{key:"item.timespent",fn:function(t){var n=t.item;return[a("v-chip",{attrs:{dark:""}},[e._v(" "+e._s(Math.abs(60*Number(n.time.split(":")[0])+Number(n.time.slice(3))-(60*Number(n.timearrived.split(":")[0])+Number(n.timearrived.slice(3)))))+" ")])]}}],null,!0)}),a("v-chip",{attrs:{dark:""}},[e._v(" "+e._s("TOTAL PROFIT: "+Number(e.totalProfit).toFixed(2)+" €")+" ")])],1)},R=[],S=(a("4de4"),a("d81d"),a("13d5"),a("fb6a"),a("ac1f"),a("1276"),{name:"Orders",props:["items"],data:function(){return{headers:[{text:"Car model",sortable:!1,value:"carModel"},{text:"Category",sortable:!1,value:"category"},{text:"Quantity",sortable:!1,value:"orderQuantity"},{text:"Price per hour in €",sortable:!1,value:"price"},{text:"Time spent in min",sortable:!1,value:"timespent"},{text:"Pickup Address",sortable:!1,value:"pickupAddress"},{text:"Destination Address",sortable:!1,value:"destinationAddress"},{text:"Pickup date",sortable:!1,value:"date"},{text:"Pickup time",sortable:!1,value:"time"},{text:"Arrived time",sortable:!1,value:"timearrived"},{text:"Time ordered",sortable:!1,value:"timestamp"},{text:"Status",sortable:!1,value:"status"},{text:"Profit",sortable:!1,value:"profit"}]}},computed:{filteredItems:function(){return this.items.map((function(e){return e})).filter((function(e){return"Completed"===e.status}))},totalProfit:function(){return this.filteredItems.map((function(e){var t=Math.abs(60*Number(e.time.split(":")[0])+Number(e.time.slice(3))-(60*Number(e.timearrived.split(":")[0])+Number(e.timearrived.slice(3))));return e.price*e.orderQuantity*t/60})).reduce((function(e,t){return[+e+ +t]}),0)}}}),D=S,H=Object(m["a"])(D,B,R,!1,null,null,null),E=H.exports;v()(H,{VChip:g["a"],VContainer:k["a"],VDataTable:C["a"],VToolbar:T["a"],VToolbarTitle:A["a"]});var M={data:function(){return{}},computed:Object(s["a"])({},Object(d["b"])({items:"getOrders"})),components:{OrdersTable:N,ProfitTable:E}},F=M,z=Object(m["a"])(F,n,i,!1,null,null,null);t["default"]=z.exports}}]);
//# sourceMappingURL=adminorders.3443129f.js.map